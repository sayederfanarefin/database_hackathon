<html xmlns="http://www.w3.org/1999/html">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Create Hackathon | Dashboard</title>

    <link rel="apple-touch-icon" sizes="180x180" th:href="@{/app-assets/apple-touch-icon.png}">
    <link rel="icon" type="image/png" sizes="32x32" th:href="@{/app-assets/favicon-32x32.png}">
    <link rel="icon" type="image/png" sizes="16x16" th:href="@{/app-assets/favicon-16x16.png}">
    <link rel="manifest" th:href="@{/app-assets/site.webmanifest}">


    <!-- Custom fonts for this template-->
    <link th:href="@{/app-assets/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet" type="text/css">
    <link
            href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
            rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"/>


    <!-- Custom styles for this template-->
    <link th:href="@{/app-assets/css/sb-admin-2.min.css}" rel="stylesheet">

</head>

<body id="page-top">

<!-- Page Wrapper -->
<div id="wrapper">

    <div th:replace="admin_sidebar :: admin_sidebar"></div>

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <!-- Topbar -->

            <div th:replace="admin_navbar :: admin_navbar"></div>


            <!-- Begin Page Content -->
            <div class="container-fluid">


                <div class="card o-hidden border-0 shadow-lg my-5">
                    <div class="card-body p-0">
                        <!-- Nested Row within Card Body -->
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="p-5">

                                    <form class="hackathon" id="createHackathonForm" enctype="utf8">


                                        <div class="col px-1 mb-2">
                                            <label for="title" class="ms-2 position-absolute"
                                                   style="margin-top: -0.25rem !important">
                                                <span class="h6 small bg-white text-muted px-1">Title (required)</span>
                                            </label>
                                            <input type="text" class="form-control mt-2" id="title" name="title"
                                                   required>
                                            <span id="titleError" class="alert alert-danger col-sm-12"
                                                  style="display:none"></span>

                                        </div>


                                        <br/>


                                        <div class="col px-1 mb-2">
                                            <label for="description" class="ms-2 position-absolute"
                                                   style="margin-top: -0.25rem !important">
                                                <span class="h6 small bg-white text-muted px-1">Description (required)</span>
                                            </label>
                                            <textarea type="text" class="form-control mt-2" id="description"
                                                      name="description" rows="6"
                                                      cols="100" required="required"> </textarea>
                                            <span id="descriptionError" class="alert alert-danger col-sm-12"
                                                  style="display:none"></span>

                                        </div>

                                        <br/>

                                        <div class="col px-1 mb-2">
                                            <p>Private Notes can be viewed by Admins only.</p>
                                            <label for="privateNotes" class="ms-2 position-absolute"
                                                   style="margin-top: -0.25rem !important">
                                                <span class="h6 small bg-white text-muted px-1">Private Notes (optional)</span>
                                            </label>
                                            <textarea type="text" class="form-control mt-2" id="privateNotes"
                                                      name="privateNotes" rows="3"
                                                      cols="100"> </textarea>
                                        </div>

                                        <br/>




                                        <div class="form-group">
                                            <label>Please select if you want to enable/disable General Board</label>
                                            <div class="radio">

                                                    <input type="radio"
                                                           value="true"
                                                           id="optionsGeneralBoardEnable" name="generalBoardEnabled"
                                                           checked > Enable
                                                <input type="radio"
                                                       value="false"
                                                       id="optionsGeneralBoardDisable" name="generalBoardEnabled"
                                                        > Disable
                                            </div>

                                        </div>


                                        <div class="form-group">
                                            <label>Please select if you want to enable/disable Leader Board.</label>
                                            <div class="radio">

                                                <input type="radio"
                                                       value="true"
                                                       id="optionsLeederBoardEnable" name="leederBoardEnabled"
                                                        > Enable
                                                <input type="radio"
                                                       value="false"
                                                       id="optionsLeederBoardDisable" name="leederBoardEnabled"
                                                       checked > Disable
                                            </div>
                                        </div>


                                        </br>

                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div class="card mb-4">
                                                    <div class="card-header">Start Date and Time (required)</div>
                                                    <div class="card-body">
                                                        <div class="form-group">
                                                            <label for="startDateTime">Start Date and Time:</label>
                                                            <input type="datetime-local" class="form-control"
                                                                   id="startDateTime" name="startDateTime" required />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="card mb-4">
                                                    <div class="card-header">End Date and Time (required)</div>
                                                    <div class="card-body">
                                                        <div class="form-group date">
                                                            <label for="endDateTime">End Date and Time:</label>
                                                            <input type="datetime-local" class="form-control"
                                                                   id="endDateTime" name="endDateTime" required/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <span id="dateTimeError" class="alert alert-danger col-sm-5"
                                                  style="display:none"></span>

                                        </div>

                                        <br/>


                                        <div class="row">
                                            <div class="col-md-6">

                                                <div class="card mb-4">
                                                    <div class="card-header">Select Tasks</div>
                                                    <div class="card-body">

                                                        <p th:if="${#lists.isEmpty(tasks)}">
                                                            No Tasks

                                                        </p>

                                                        <select id="availableItemsTask" class="form-control" multiple
                                                                th:if="${tasks != null}"
                                                        >

                                                            <option th:each="task : ${tasks}" th:value="${task.id}"
                                                                    th:text="${task.title}">Task n
                                                            </option>
                                                        </select>
                                                        <a id="btnAddTask"
                                                           class="btn btn-outline-primary btn-block mt-2">Add
                                                            &raquo;</a>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="col-md-6">

                                                <div class="card mb-4">
                                                    <div class="card-header">Selected Tasks (required)</div>
                                                    <div class="card-body">

                                                        <select id="selectedItemsTask" class="form-control" multiple
                                                                name="tasks" required></select>
                                                        <a id="btnRemoveTask"
                                                           class="btn btn-outline-danger btn-block mt-2">&laquo;
                                                            Remove</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <br>


                                        <div class="row">
                                            <div class="col-md-6">

                                                <div class="card mb-4">
                                                    <div class="card-header">Select Users</div>
                                                    <div class="card-body">
                                                        <div class="input-group mb-3">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text" id="basic-addon1"><i
                                                                        class="fa fa-user"
                                                                        aria-hidden="true"></i></span>
                                                            </div>
                                                            <input type="text" class="form-control"
                                                                   placeholder="Search users by email to select"
                                                                   id="searchInput">
                                                            <ul id="searchResults"></ul>
                                                        </div>

                                                        <p th:if="${#lists.isEmpty(users)}">
                                                            No Users

                                                        </p>

                                                        <select id="availableItemsUsers" class="form-control" multiple
                                                                th:if="${users != null}"
                                                        >

                                                            <option th:each="user : ${users}" th:value="${user.id}"
                                                                    th:text="${user.getFullName()}">User n
                                                            </option>
                                                        </select>

                                                        <div class="row">
                                                            <div class="col-5">
                                                                <a id="btnAddUsersAll"
                                                                   class="btn btn-primary btn-block mt-2">Add All</a>

                                                            </div>
                                                            <div class="col-7">
                                                                <a id="btnAddUsers"
                                                                   class="btn btn-outline-primary btn-block mt-2">Add
                                                                    &raquo;</a>

                                                            </div>

                                                        </div>

                                                    </div>
                                                </div>

                                            </div>
                                            <div class="col-md-6">

                                                <div class="card mb-4">
                                                    <div class="card-header">Selected Users (required)</div>
                                                    <div class="card-body">

                                                        <div class="input-group mb-4 block">
                                                            <div class="input-group-prepend">

                                                                <span class="input-group-text" id="basic-addon2"><i
                                                                        class="fa fa-user"
                                                                        aria-hidden="true"></i></span>
                                                            </div>
                                                            <input type="text" class="form-control"
                                                                   placeholder="Search users by email to remove"
                                                                   id="searchInput2">

                                                            <ul id="searchResults2"></ul>

                                                        </div>


                                                        <select id="selectedItemsUsers" class="form-control" multiple
                                                                name="users" required></select>

                                                        <div class="row">
                                                            <div class="col-7">
                                                                <a id="btnRemoveUsers"
                                                                   class="btn btn-outline-danger btn-block mt-2">&laquo;
                                                                    Remove</a>
                                                            </div>
                                                            <div class="col-5">
                                                                <a id="btnRemoveUsersAll"
                                                                   class="btn btn-danger btn-block mt-2"> Remove All</a>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="form-group">
                                            <span id="globalError" class="alert alert-danger col-sm-10"
                                                  style="display:none; width: 100%;"></span>
                                            <span id="globalSuccess"
                                                  class="alert alert-success col-sm-10 align-items-center"
                                                  style="display:none; width: 100%;">Hackathon created!</span>

                                        </div>

                                        <button type="submit" class="btn btn-primary btn-user btn-block">Create
                                            Hackathon
                                        </button>


                                    </form>


                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!-- /.container-fluid -->

        </div>
        <!-- End of Main Content -->

        <!-- Footer -->
         <footer th:replace="footer :: footer"></footer>
        <!-- End of Footer -->

    </div>
    <!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->

<!-- Scroll to Top Button-->
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>


<!-- Bootstrap core JavaScript-->


<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>


<!--<script th:src="@{/app-assets/vendor/jquery/jquery.min.js}"></script>-->
<script th:src="@{/app-assets/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>

<!-- Core plugin JavaScript-->
<script th:src="@{/app-assets/vendor/jquery-easing/jquery.easing.min.js}"></script>

<!-- Custom scripts for all pages-->
<script th:src="@{/app-assets/js/sb-admin-2.min.js}"></script>

<!-- Page level plugins -->
<!--<script th:src="@{/app-assets/vendor/chart.js/Chart.min.js}"></script>-->

<!-- Page level custom scripts -->
<!--<script th:src="@{/app-assets/js/demo/chart-area-demo.js}"></script>-->
<!--<script th:src="@{/app-assets/js/demo/chart-pie-demo.js}"></script>-->


<script th:inline="javascript">
    var serverContext = [[@{/}]];
        $(document).ready(function () {
            $('form').submit(function (event) {
                register(event);
            });
        });

    function register(event) {

        // window.alert("i am here!");

        event.preventDefault();
        $(".alert").html("").hide();
        $(".error-list").html("");

        var textarea = document.getElementById('description');

        // Check if the value of the textarea is empty or only contains white spaces
        if (textarea.value.trim() === '') {

            $("#globalError").show().append("Description is empty.</br>");
        } else {

        var formData = $('form').serialize();
        $.post(serverContext + "hackathon/create", formData, function (data) {
            if (data.message == "success") {


                $("#globalSuccess").show().append("Hackathon Created! <br/>");
                document.getElementById("createHackathonForm").reset();

                setTimeout(function () {
                    // Reload the page
                    location.reload();
                }, 1500);

                // window.location.href = serverContext + "successRegister.html";
            }

        })
            .fail(function (data) {
                if (data.responseJSON.error.indexOf("MailError") > -1) {
                    window.location.href = serverContext + "emailError.html";
                } else if (data.responseJSON.error == "HackathonAlreadyExist") {
                    $("#emailError").show().html(data.responseJSON.message);
                } else if (data.responseJSON.error.indexOf("InternalError") > -1) {
                    // window.location.href = serverContext + "login?message=" + data.responseJSON.message;
                } else {
                    var errors = $.parseJSON(data.responseJSON.message);
                    $.each(errors, function (index, item) {
                        if (item.field) {
                            $("#" + item.field + "Error").show().append(item.defaultMessage + "<br/>");
                        } else {
                            $("#globalError").show().append(item.defaultMessage + "<br/>");
                        }

                    });
                }
            });
        }
    }

</script>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        var btnAdd = document.getElementById("btnAddTask");
        var btnRemove = document.getElementById("btnRemoveTask");

        btnAdd.addEventListener("click", function () {
            moveItems("availableItemsTask", "selectedItemsTask");
        });

        btnRemove.addEventListener("click", function () {
            moveItems("selectedItemsTask", "availableItemsTask");
        });

        function moveItems(sourceId, targetId) {
            var sourceSelect = document.getElementById(sourceId);
            var targetSelect = document.getElementById(targetId);

            var selectedOptions = [].slice.call(sourceSelect.selectedOptions);
            selectedOptions.forEach(function (option) {
                targetSelect.appendChild(option);
            });
        }
    });
</script>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        var btnAdd = document.getElementById("btnAddUsers");
        var btnAddAll = document.getElementById("btnAddUsersAll");
        var btnRemove = document.getElementById("btnRemoveUsers");
        var btnRemoveAll = document.getElementById("btnRemoveUsersAll");

        btnAddAll.addEventListener("click", function () {
            selectAllItemsUsers("availableItemsUsers");
            moveItems("availableItemsUsers", "selectedItemsUsers");
        });

        btnRemoveAll.addEventListener("click", function () {

            selectAllItemsUsers("selectedItemsUsers");
            moveItems("selectedItemsUsers", "availableItemsUsers");
        });


        btnAdd.addEventListener("click", function () {
            moveItems("availableItemsUsers", "selectedItemsUsers");
        });

        btnRemove.addEventListener("click", function () {
            moveItems("selectedItemsUsers", "availableItemsUsers");
        });

        function moveItems(sourceId, targetId) {
            var sourceSelect = document.getElementById(sourceId);
            var targetSelect = document.getElementById(targetId);

            var selectedOptions = [].slice.call(sourceSelect.selectedOptions);
            selectedOptions.forEach(function (option) {
                targetSelect.appendChild(option);
            });
        }
    });
</script>


<script>
    $(function () {

        var startDateTime = $('#startDateTime');
        var endDateTime = $('#endDateTime');

        var now = new Date();
        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
        var noww = now.toISOString().slice(0, 16)
        var selectedStartTime = noww;
        startDateTime.bind("input", function (evt) {
            selectedStartTime = evt.target.value;
            if (selectedStartTime < noww) {
                $("#dateTimeError").show().html("Hackathon Start Date and Time can not be in the past.");
            } else {
                $("#dateTimeError").hide();
            }

        });

        endDateTime.bind("input", function (evt) {
            selectedEndTime = evt.target.value;
            if (selectedStartTime > selectedEndTime) {
                $("#dateTimeError").show().html("Hackathon End Date and Time can not be before the Starting Date and Time.");
            } else {
                $("#dateTimeError").hide();
            }

        });


    });
</script>


<script th:inline="javascript">
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResults');
    const items = /*[[${users}]]*/ [];

    function performSearch(query) {
        searchResults.innerHTML = '';

        const filteredItems = items.filter(item => item.email.toLowerCase().includes(query.toLowerCase()));

        filteredItems.forEach(item => {
            const li = document.createElement('li');
            li.textContent = item.firstName;
            searchResults.appendChild(li);
        });
    }

    searchInput.addEventListener('input', () => {
        performSearch(searchInput.value);
    });


    function selectAllItemsUsers(selectorId) {
        const selectElement = document.getElementById(selectorId);
        const options = selectElement.options;

        for (let i = 0; i < options.length; i++) {
            options[i].selected = true;
        }
    }
</script>


</body>

</html>